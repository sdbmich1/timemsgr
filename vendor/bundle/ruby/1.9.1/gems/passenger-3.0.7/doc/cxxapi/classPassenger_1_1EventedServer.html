<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Passenger: Passenger::EventedServer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespacePassenger.html">Passenger</a>::<a class="el" href="classPassenger_1_1EventedServer.html">EventedServer</a>
  </div>
</div>
<div class="contents">
<h1>Passenger::EventedServer Class Reference</h1><!-- doxytag: class="Passenger::EventedServer" -->
<p>A base class for writing single-threaded, evented servers that use non-blocking I/O.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="EventedServer_8h_source.html">EventedServer.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Passenger::EventedServer:</div>
<div class="dynsection">
<div class="center"><img src="classPassenger_1_1EventedServer__inherit__graph.png" border="0" usemap="#Passenger_1_1EventedServer_inherit__map" alt="Inheritance graph"/></div>
<map name="Passenger_1_1EventedServer_inherit__map" id="Passenger_1_1EventedServer_inherit__map">
<area shape="rect" id="node3" href="classPassenger_1_1EventedMessageServer.html" title="Note when overriding onNewClient: call the parent method first! It does some initialization..." alt="" coords="5,83,253,112"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="classPassenger_1_1EventedServer-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPassenger_1_1EventedServer.html#a7db4c8d0ad8aa77bcb40344e53319f11">onClientDisconnected</a> (<a class="el" href="classPassenger_1_1EventedClient.html">EventedClient</a> *client)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called when a client has been disconnected.  <a href="#a7db4c8d0ad8aa77bcb40344e53319f11"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>A base class for writing single-threaded, evented servers that use non-blocking I/O. </p>
<p>It uses libev for its event loop. <a class="el" href="classPassenger_1_1EventedServer.html" title="A base class for writing single-threaded, evented servers that use non-blocking I/O...">EventedServer</a> handles much of the situps regarding client connection management and output buffering and tries to make it easy to implement a zero-copy architecture.</p>
<h2>Basic usage</h2>
<p>Derived classes can override the onClientReadable() method, which is called every time a specific client becomes readable. It is passed a <a class="el" href="classClient.html" title="A representation of a Client from the Server&#39;s point of view.">Client</a> object which contains information about the client, such as its file descriptor. One can use the read() system call in that method to receive data from the client. Please note that client file descriptors are always set to non-blocking mode so you need to handle this gracefully.</p>
<p><a class="el" href="classPassenger_1_1EventedServer.html" title="A base class for writing single-threaded, evented servers that use non-blocking I/O...">EventedServer</a> provides the write() method for sending data to the client. This method will attempt to send the data to the client immediately; if it fails with EAGAIN then <a class="el" href="classPassenger_1_1EventedServer.html" title="A base class for writing single-threaded, evented servers that use non-blocking I/O...">EventedServer</a> will take care of scheduling the send at a later time when the client is ready again to receive data.</p>
<p>To disconnect the client, call disconnect(). The connection might not be actually closed until all pending outgoing data have been sent out, but all the gory details is taken care of for you.</p>
<h2>Keeping per-client information</h2>
<p>If you need to keep per-client information then you can override the createClient() method and make it return an object that's a subclass of EventedServer::Client. This object is passed to onClientReadable(), so in there you can just cast the client object to your subclass.</p>
<h2><a class="el" href="classClient.html" title="A representation of a Client from the Server&#39;s point of view.">Client</a> object life times</h2>
<p>All client objects are destroyed along with the <a class="el" href="classPassenger_1_1EventedServer.html" title="A base class for writing single-threaded, evented servers that use non-blocking I/O...">EventedServer</a>. Disconnecting a client also causes it to be destroyed after the current event handler has run or a short period of time after that. </p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a7db4c8d0ad8aa77bcb40344e53319f11"></a><!-- doxytag: member="Passenger::EventedServer::onClientDisconnected" ref="a7db4c8d0ad8aa77bcb40344e53319f11" args="(EventedClient *client)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Passenger::EventedServer::onClientDisconnected </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPassenger_1_1EventedClient.html">EventedClient</a> *&nbsp;</td>
          <td class="paramname"> <em>client</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Called when a client has been disconnected. </p>
<p>This may either be triggered immediately by disconnect() or triggered after pending data has been sent out. This means that if you call disconnect() from onClientReadable() you need take care of the possibility that control returns to onClientReadable() after this method is done.</p>
<p>Please note that when <a class="el" href="classPassenger_1_1EventedServer.html" title="A base class for writing single-threaded, evented servers that use non-blocking I/O...">EventedServer</a> is being destroyed, <a class="el" href="classPassenger_1_1EventedServer.html#a7db4c8d0ad8aa77bcb40344e53319f11" title="Called when a client has been disconnected.">onClientDisconnected()</a> is *not* triggered. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="EventedServer_8h_source.html">EventedServer.h</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>
